# GO语言学习笔记
学习时的Go语言版本1.14.4
Go语言起源于2007年，由Google公司研发与维护，于2009年正式对外发布。
学习地址：

[Go指南](http://go-tour-zh.appspot.com/list)

[Go 入门指南|技术论坛](https://learnku.com/docs/the-way-to-go)

Go的格言： “没有不必要的代码！”

Go语言的特性：

- Go语言没有类和继承的概念，它通过接口（interface）的概念来实现多态性。
- Go语言属于强类型、静态类型语言。
- 函数是Go语言中的基本构件。
- Go语言支持交叉编译。比如在Linux系统上开发Windows下运行的应用程序。

基础指令：

- go version    查看Go版本信息
- gofmt hello.world.go      打印格式化后的结果而不重写文件
- gofmt -w hello.world.go   格式化并重写原代码
- gofmt -w *.go     会格式化并重写所有 Go 源文件
- gofmt map1        会格式化并重写 map1 目录及其子目录下的所有 Go 源文件
- gofmt -r '(a) -> a' –w *.go       替换所有源文件中的(a) 为 a

目前版本实现的三个Go工具

1. go install       是安装Go包的工具，主要安装非标准库的包文件，将源文件编译成对象文件。
2. go fix       将Go代码从旧的发行版迁移到最新的发行版
3. go test      是一个轻量级的单元测试框架
---

Go语言数据的基本类型：
1. bool     布尔类型
2. string   字符串类型
3. number   数字类型
    1. int      整数    是计算最快的类型
        1. int8     -128 -> 127
        2. int16    -32768 -> 32768
        3. int32    -2,147,483,648 -> 2,147,483,647
        4. int64    -9,223,372,036,854,775,808 -> 9,223,372,036,854,775,807
    2. uint     无符号整数
        1. uint8    0 -> 255
        2. uint16   0 -> 65535
        3. uint32   0 -> 4,294,967,295
        4. uint64   0 -> 18,446,744,073,709,551,615
    3. float    浮点型
        1. float32  +- 1e-45 -> +- 3.4 * 1e38   精确到小数点后7位
        2. float64  +- 5 1e-324 -> 107 1e308    精确到小数点后15位，推荐优先使用
4. 数组             值类型，使用中括号[]，类型统一
5. 切片（slice）    引用类型，对数组的一个连续片段的引用
6. Map              引用类型，无序，一个由key和value组成的类型统一的键值对结构数据
7. 结构体（struct ）    值类型，不限类型的属性和值组成

---

Go语言注意事项：

1. 不能使用单个下划线（_）作为标识符，实际上下划线（_）是一个只写变量。
2. 字符串不能使用单引号。
3. 每个 Go 文件都属于且仅属于一个包
4. 每一段代码只会被编译一次
5. Go语言中包中的对象，以是否大小写开头来区分是否被导出的对象，其中大写开头的标识符对象为导出（类似于面向对象语言中的public），其中小写开头的标识符的对象对外是不可见的，对内为可见且可用的（类似于面向对象语言中的private）。
6. Go语言的作用域中，只有函数提升，没有变量提升
7. 自定义函数无法用于常量的复制，因为在编译期间自定义函数属于未知，但是内置函数可以，如 len()。
8. 变量的初始化声明的简写方式（:=），系统会自动推断类型，只能在函数体内使用。
9. 局部作用域声明的变量必须使用，全局声明的变量可以不使用。
10. 多变量赋值只能在局部作用域使用，多变量声明不受此限制。
11. 条件判断时，哪怕只有一行代码，也不能省略大括号{}
12. for 和 if 等条件判断不能用()
13. 函数定义时，只要有命名返回值，必须使用()括起来
14. new() 是一个函数，不要忘记它的括号
15. 匿名函数必须在函数作用域中声明，不能在全局作用域声明
16. 数组的数目，在声明时就需要给出（编译时需要知道数组的长度以便分配内存），数组的长度最大为2GB
17. 打印时强烈建议引用fmt包，内置函数print和println打印复杂类型时要么报错，要么只打印内存地址
18. 切片不能被重新分片以获取数组的前一个元素，但是可以获取后一个元素，如果后一个元素有值
19. 绝对不要用指针指向slice，因为切片本身是一个引用类型，所以它本身就是一个指针
20. len()函数计算字符串的长度时是按字节数计算的，但是可以通过 len([]int32(s)) 来获得字符串的数量，不过使用utf8.RuneCountInString(s)计算的效率会更高。
21. str[start:end] 获取某个字符串， 是按字节数索引的
22. Go语言中字符串是不可变的，如果需要更改字符串，需要先转换成字节数组，改变后在用内置函数string()转换成字符串
23. 相等运算符（==）并不是严格意义上的相等，也不是非严格意义上的相等，如 0 == 0.00 结果是true
24. new() 用于值类型， make() 用于引用类型
25. 在一个结构体中，每种数据类型，只能有一个匿名字段
26. 结构体中，字段名，外层名字会覆盖内层名字，但是在同一级别有两个相同的名字时，调用时会报错，必须程序员自己修正
27. 不要再String()方法里面调用涉及String()方法的方法，会导致意料之外的错误，比如隐式的循环调用，会导致内存溢出。
28. 
---

基本知识：

- 使用import导入包后，可以定义或声明0或多个常量（const）、变量（var）、类型（type）
- 使用关键字 func 定义函数
- main 函数是每一个可执行程序所必须包含的，每个包中只能有一个main函数。
- init和main函数都是自执行函数，默认情况下执行顺序依次是init > main，并且都不能有参数和返回值。
- go doc    命令可以显示包的文档说明
- 常量的数据类型只能是：布尔型、数字型（整数型、浮点型和复数）、字符串型
- 常量支持并行赋值（类似于JavaScript中的解构赋值）
- 关于iota，简单理解就是，每遇到一次const关键字，iota就重置为0。
- 当一个变量被声明后，系统会自动赋给该变量类型的零值：
    - int       0
    - float     0.0
    - bool      false
    - string    ""
    - 指针      nil
- 所有的内存在Go中都是经过初始化的。
- rand.Intn(n)     返回介于[0, n]之间的伪随机数，不包括n
- rand.Float32()和rand.Float64()返回介于[0.0, 1.0]之间的数字，包括0.0，不包括1.0
- rand.Seed(value)  提供伪随机数的生成种子，推荐使用当前时间的纳秒数
- 字符串本质上是一个字节数组
- strings   以下是strings包中关于字符串操作的函数
    1. HasPrefix(s, prefix string) bool 判断字符串 s 是否以 prefix 开头
    2. HasSuffix(s, suffix string) bool 判断字符串 s 是否以 suffix 结尾
    3. Contains(s, substr string) bool  判断字符串 s 是否包含 substr
    4. Index(s, str string) int 返回字符串 str 在字符串 s 中的索引（str 的第一个字符的索引），-1 表示字符串 s 不包含字符串 str
    5. LastIndex(s, str string) int 返回字符串 str 在字符串 s 中最后出现位置的索引（str 的第一个字符的索引），-1 表示字符串 s 不包含字符串 str
    6. IndexRune(s string, r rune) int  如果 ch 是非 ASCII 编码的字符，建议使用此函数来对字符进行定位
    7. Replace(str, old, new, n) string 用于将字符串 str 中的前 n 个字符串 old 替换为字符串 new，并返回一个新的字符串，如果 n = -1 则替换所有字符串 old 为字符串 new
    8. Count(s, str string) int 计算字符串 str 在字符串 s 中出现的非重叠次数
    9. Repeat(s, count int) string  用于重复 count 次字符串 s 并返回一个新的字符串
    10. ToLower(s) string  将字符串中的 Unicode 字符全部转换为相应的小写字符
    11. ToUpper(s) string  将字符串中的 Unicode 字符全部转换为相应的小写字符
    12. TrimSpace(s) string 剔除字符串开头和结尾的空白符号.
    13. Trim(s, "cut") string   将开头和结尾的 cut 去除掉
    14. TrimLeft(s, 'cut') string   只将开头的 cut 去除掉
    14. TrimRight(s, 'cut') string   只将结尾的 cut 去除掉
    15. Fields(s) slice 利用空白作为分隔符，分割成若干份
    16. Split(s, sep)  slice    自定义分割符号对字符串分割
    17. strings.Join(sl []string, sep string) string    将元素类型为 string 的 slice 使用分割符号来拼接组成一个字符串
    18. NewReader(str) 生成一个 Reader 并读取字符串中的内容，然后返回指向该 Reader 的指针
- strconv   以下是strconv包中关于字符串与其他类型转换的函数
    1. IntSize    获取程序运行的操作系统平台下 int 类型所占的位数
    2. Itoa(i int) string   返回数字 i 所表示的字符串类型的十进制数
    3. FormatFloat(f float64, fmt byte, prec int, bitSize int) string 将 64 位浮点型的数字转换为字符串，其中 fmt 表示格式（其值可以是 'b'、'e'、'f' 或 'g'），prec 表示精度，bitSize 则使用 32 表示 float32，用 64 表示 float64。
    4. Atoi(s string) (i int, err error)    将字符串转换为 int 型。
    5. ParseFloat(s string, bitSize int) (f float64, err error) 将字符串转换为 float64 型。

- time 提供了一个数据类型 time.Time（作为值使用）以及显示和测量时间和日期的功能函数
    1. Now()    获取当前时间，如 var t = time.Now()
    2. t.Day()      天
    3. t.Month()    月
    4. t.Year()     年
    5. t.Format(layout string) string   根据一个格式化字符串来将一个时间 t 转换为相应格式的字符串，预定义格式time.ANSIC 或 time.RFC822

- 一个指针变量可以指向任何一个值的内存地址
- 指针未分配到任何变量时，值为 nil ，一般指针变量缩写为 ptr
- &a（返回变量a的内存地址）
- *int（声明指针变量的类型）
- *a（返回变量a在内存地址中的值）
- 函数定义时，如果定义的是命名返回值，则return可以不带参数
- 函数即便定义了命名返回值，依旧可以无视它而返回明确的值
- params ...interface{}     可以获取到未定义类型/未定义数量的入参集合
- defer 关键字可以延迟函数在调用之后才执行
- 当有多个defer注册时，执行顺序为逆序执行（类似于栈，先进后出）
- 内置函数：
    1. close    用于管道通信
    2. len      返回某个类型的长度和数量（字符串、数组、切片、map、管道）
    3. cap      返回某个类型的最大容量（只能用于切片、map）
    4. new      分配内存，用于值类型和用户自定义的类型
    5. make     分配内存，用于内置引用类型（切片、map、管道）
    6. copy     拷贝切片，后面的值会拷贝给前面的值，返回已拷贝的数量，如：copy(slTo, slFrom)
    7. append   从切片后面添加新元素，返回新切片 如：append(sl3, 4, 5, 6) 或者 append(sl3, sl4...)
    8. panic、recover    都用于错误处理
    9. print、println   底层打印函数，部署环境中建议用fmt包
    10. complex、real、imag     用于创建和操作复数

- 如果需要大量的重复计算时，建议使用数组或切片或map缓存计算的值，对优化计算性能，效果显著。
- 数组是具有相同唯一类型的一组已编号且长度固定的数据项序列。类型可以是原始类型或自定义类型，长度必须是一个常量表达式，且必须是一个非负整数。
- Go语言中，数组是一种值类型，所以可以通过new()来创建
- 想在函数中修改复杂类型的原值，需要传变量的引用指针
- 切片（slice）是对数组的一个连续片段的引用，这个引用可以是整个数组或一部分
- 切片是引用类型，且是一个长度可变的数组，最小为0，最长为相关数组的长度
- 切片的初始化格式： var slice1 []type = arr1[start: end]
- slice2 := slice1[:cap(slice1)] 可以把切片扩展到最大
- 修改切片中的值，会影响到原数组的值
- 因为字符串是纯粹不可变的字节数组，所以他们也可以被切分成切片
- new() 和 make() 的区别
    - new(T) 返回一个指向类型为T，值为0的地址的指针，适用于值类型，如数组和结构体
    - make(T) 返回一个类型为T的初始值，适用于引用类型，如切片、map、channel
- xt := reflect.TypeOf(var)   返回检测对象的类型
- xv := reflect.ValueOf(var)  返回检测对象的值
- xt.Kind() 和 xv.Kind() 总是返回底层类型
- 其中xv.Type()     返回类型，xt没有Type方法
- xv.Interface()    返回还原后的值
- v.(type) 此种方式只能在switch中使用，且需提前知道有几种类型，函数没有返回值
- map 是引用类型，可以动态添加，未初始化的map值为nil，声明格式：var map1 map[keytype]valuetype
- map数据类型中的key一般是基本类型，value可以是任何类型
- _, ok := map1[key1] 可以通过ok的bool值判断map1中是否有元素key1。
- delete(map1, key1) 删除map1中的key1元素，不存在key1时，不会报错
- map默认时无序的，不会自动排序
- sort 常用的排序方法
    1. Strings()    字符串排序
    2. Ints()       整数排序
- import . "./pack1" 使用.作为包的别名时，可以省略包名，直接调用其中的变量或方法
- import _ "./pack1" 使用下划线导入包时，只会执行其中的init函数，并初始化全局变量
- 结构体（struct）属于值类型，可以通过new函数创建
- new(struct1) 和 &struct1{}    是等价的
- unsafe.Sizeof(T{})    返回结构体T的实例占用的内存大小
- 结构体可以包含一个或多个匿名（或内嵌）字段，结构体可以包含内嵌结构体
- Go语言中的继承是通过内嵌或组合来实现的
- Go语言中，一个类型加上它的方法等价于面向对象中的一个类
- 方法的定义必须与接收者类型（receiver_type），在同一个包中被声明
- 类型关联的方法不写在类型结构里面；类型和方法的关联由接收者来建立
- 函数和方法的区别：
    1. 函数将变量作为参数：fn1(recv); 方法在变量上被调用：recv.Method1()
    2. 当接收者或参数为指针时，方法和参数都可以改变其值或状态
    3. 方法中，接收者必须有一个显式的名字，且必须在方法中被使用

- 方法也是可以通过内嵌结构体，实现方法的继承，或者在功能类型中声明一个具名字段
- runtime.GC()  可以显示的触发垃圾回收，回收时会有短暂的性能下降

- 接口定义了一组方法（方法集），不包含方法的实现代码，不能包含变量
- 按约定，只有一个方法的接口名字，由方法名加[e]r后缀组成
- 接口的类型断言，varI.(*Struct) 或者 var1.(myInterface)
- Go语言规范，定义接口方法集的调用规则：
    1. 类型*T的可调用方法集包含接受者为*T或T的所有方法集
    2. 类型T的可调用方法集包含接受者为T的所有方法
    3. 类型T的可调用方法集不包含接受者为*T的方法

- 每个interface{}变量在内存中占据两个字节，一个用来存储包含它的类型，一个用来存储它包含的数据或者指向数据的指针
- 赋值数据切片至空接口切片，必须使用for-range语句一个一个地复制。
- Go没有类，而是松耦合的类型、方法对接口的实现
- 数据封装，通过标识符的首字母大小写，区分包外和包内可见
- 继承，通过组合实现（内嵌一个以上的类型）
- 多态，通过接口实现（某个类型的实例可以赋给它所实现的任意接口类型的变量）
————————————————
优先级     运算符

 7      ^ !

 6      * / % << >> & &^

 5      + - | ^

 4      == != < <= >= >

 3      <-

 2      &&

 1      ||

————————————————

替换标识符

%d      数字
%s      字符串
%T      格式化描述符
%#v     实例的完整输出，包括它的字段

------------------------------------------------------
未能深刻理解的点：
指针、method、interface

------------------------------------------
Go语言中包含的所属有类型
    Bool
    Int
    Int8
    Int16
    Int32
    Int64
    Uint
    Uint8
    Uint16
    Uint32
    Uint64
    Uintptr
    Float32
    Float64
    Complex64
    Complex128
    Array
    Chan
    Func
    Interface
    Map
    Ptr
    Slice
    String
    Struct
    UnsafePointer